<!DOCTYPE HTML >
<html>

<HEAD>
    <META charset="UTF-8">
    <META name="description" content="z = f(x, y)で定義される曲面を隠線処理が施されたメッシュで描画するページの簡易解説です。ユーザーが任意の曲面を入力して描画させる方法についても解説しています。">
    <META name="keywords" content="3D,曲面,プロット,隠線,陰線,メッシュ,回転,アングル,ユーザー,任意,入力,解説">

    <title>Petit Document: Rendering Surfaces with Hidden Line Meshes</title>

    <!-- favicon-->
    <link rel="shortcut icon" href="image/SRTLM_img/favicon.ico">

    <!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- css start -->

        <!-- kz_etc start :: class指定:change_border_color, 全ファイル共通:リンク文字色, フォーカスリング -->
        <link rel="stylesheet" href="libs/etc/css/kz_footer_style.css" type="text/css">
        <link rel="stylesheet" href="libs/etc/css/kz_etc_style.css" type="text/css">
        <!-- kz_etc end -->

    <!-- css end -->

    <!-- js start -->

        <!-- jQuery start -->
        <script src="libs/jQuery/js/jquery-1.6.1.min.js" type="text/javascript"></script>
        <!-- kz_style start - img jq_blink, img jq_change -->
        <script src="libs/jQuery/kz/js/jq_kz_style.js" type="text/javascript"></script>
        <!-- kz_style end -->
        <!-- jQuery end -->

        <!-- Sandbox DropDownMenu start -->
        <script src="libs/sandbox/js/script.js" type="text/javascript"></script>
        <!-- Sandbox DropDownMenu end -->

        <script type="text/javascript"
            src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
        </script>
        <script type="text/x-mathjax-config">
            MathJax.Hub.Config({
                TeX: { equationNumbers: { autoNumber: "AMS" }},
                tex2jax: {
                    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                    processEscapes: true
                },
                "HTML-CSS": { matchFontHeight: false },
                displayAlign: "left",
                displayIndent: "2em"
            });
        </script>

        <!-- deq initialize -->
        <script src="libs/etc/js/deq00_doc2.js" type="text/javascript"></script>

    <!-- js end -->
</HEAD>

<BODY id="common-k" onload="initialize()">

    <header>
        <a name="page_top"></a>
        <div class="center jQ_change navbox" >
            <nav>
                <IMG src="image/top/kz.gif" height="15" class="logo_img">
                <ul class="menu" id="menu" >
                    <li class="pb40"><a href="index.html" class="menulink">Home</a></li>
                    <li class="pb40"><a href="whatnew.html" class="menulink">What's New</a></li>
                    <li class="pb40"><a href="etc.html" class="menulink">E.T.C.</a></li>
                    <li class="pb40"><a href="fs01.html" class="menulink">The Scenery</a>
                        <ul>
                            <li class="pb40"><a href="fs01_sc_top.html" class="sub">Screen Shots</a></li>
                            <li class="pb40"><a href="fs01_ls_top.html" class="sub">Snap Shots</a></li>
                        </ul>
                    </li>
                    <li class="pb40"><a href="link01.html" class="menulink">Links</a></li>
                    <li class="about"><a href="fs01_about.html" class="menulink">about Kz</a></li>
                </ul>
            </nav>
            <div class="c-both"></div>
        </div>
        <!-- Sandbox DropDownMenu start-->
        <script type="text/javascript">
            var menu=new menu.dd("menu");
            menu.init("menu","menuhover");
        </script>    <!-- Sandbox DropDownMenu end -->
    </header>

    <div id="main720"> <!-- ① page main: start -->

        <!-- title -->
        <div id="title20">
            <h3 class="pt30 pb40">
                隠線処理が施されたメッシュによる曲面の描画
                &emsp;
                簡易解説
            </h3>
        </div>

        <!-- contents -->
        <div class="pic-left720 pb40">
            <div class="fwb pb10" style="line-height:160%">
                <p class="pb10">
                    このツールはz = f(x, y)で定義される関数のグラフ(曲面)を隠線処理が施されたメッシュで描画します。
                    f(x, y)が与えられたとき、普通は最大/最小値や極値などを調べて関数の概形を調べることになりますが、
                    「この関数、どんな形をしているんだろう？」という疑問に対して、
                    直感的に形状を把握することができれば便利だろうなと思って、作成しました。
                    3次元の曲面を2次元に投影するので隠線処理を施さないと非常に分かり難くなってしまいます｡
                    一応、頑張って視点位置から見えている線と見えていない線の判定を行っていますが、
                    たまに見えないはずの線が透けてしまう場合があります。
                    この点については今後の課題としたいと思います。
                </p>
                <p class="pb10">
                    画面右上のセレクトボックスから関数を選択し、スタートボタンを押すと曲面が描画されます。
                    描画ウインドウの右と下のスライダーをマウスで動かすと、視点が移動して曲面が回転します。
                    右のスライダーは視点の上下の移動に対応し、下のスライダーは視点の左右の移動に対応します。
                </p>
                <p class="pb40">
                    ( 描画ページではLocal Storageを使用しています。<a href="#*1">脚注 [1]</a> 参照。)<br>
                </p>
            </div>

            <div class="pb30 fwb">
                <p>
                    [Ⅰ] &emsp; 画面について簡単に説明したいと思います。
                </p>
            </div>

            <div class="fwb pb10">
                <p>
                    <img src="image/pers/Pers_v1_over_view.jpg" border="0">
                </p>
            </div>

            <div class="fwb pb30">
                <ol class="list_none fwm pb40, pl40">
                    <li class="pb10"><a href="#s1">関数の選択</a></li>
                    <li class="pb10"><a href="#s2">Meshの設定</a></li>
                    <li class="pb10"><a href="#s3">Rangeの設定</a></li>
                    <li class="pb10"><a href="#s4">Angleの設定</a></li>
                    <li class="pb10"><a href="#s5">リセットボタン</a></li>
                </ol>
            </div>

            <div class="pl20">
                <div class="pic-left720 fwb pb20">
                    <div class="contents-title-left pb20"
                        <p id="s1">
                            [1] 関数の選択
                        </p>
                    </div>
                    <div class="contents-title-right"
                        <p>
                            <!--<a href="#title20">トップへ</a>-->
                        </p>
                    </div>
                    <div class="c-both"></div>
                    <p class="pl0 pb10 fwm">
                        セレクトボックスから描画させたい関数を選択します。
                        いくつかのセクションに分かれていますが、これについては後で説明します。
                        関数が選択されると、セレクトボックスの下に、式が表示されます。
                        スタートボタンを押すことで曲面が描画されます。
                    </p>
                </div>

                <div class="pic-left720 fwb pb20">
                    <div class="contents-title-left pb20"
                        <p id="s2">
                            [2] Meshの設定
                        </p>
                    </div>
                    <div class="contents-title-right"
                        <p>
                            <!--<a href="#title20">トップへ</a>-->
                        </p>
                    </div>
                    <div class="c-both"></div>
                    <p class="pl0 pb10 fwm">
                        描画に使用するラインの数を設定します。
                        [Calc.]は計算で使用するライン数です。
                        [Drawing]は実際に描画するライン数です。
                        ライン数を大きくするとメッシュが密になり曲面がなめらかに表示されますが、
                        計算量が増えるので、描画された曲面を回転させるときの動きがギクシャクすることがあります。
                        デフォルトは[Calc.], [Drawing]とも 20 です。<a href="#p1">※註</a>
                    </p>
                    <p class="pl0 pb10 fwm">
                        [Drawing]は[Calc.]で選択されたライン数と同じか、1/2, 1/4などの数を選択することができます。
                    </p>
                    <p class="pl0 pb10 fwm">
                        変更後はスタートボタンを押すことで、再描画されます。
                    </p>
                    <p class="pl0 pb10 fwm">
                        SpacingとScalingは表示のみで、入力や選択はできません。
                        Spacingは描画領域におけるラインの間隔です。
                        Scalingは3次元で曲面を収める箱(縦/横:12、高さ:6)に対する描画範囲の拡大(縮小)率です。
                    </p>
                </div>

                <div class="pic-left720 fwb pb20">
                    <div class="contents-title-left pb20"
                        <p id="s3">
                            [3] Rangeの設定
                        </p>
                    </div>
                    <div class="contents-title-right"
                        <p>
                            <!--<a href="#title20">トップへ</a>-->
                        </p>
                    </div>
                    <div class="c-both"></div>
                    <p class="pl0 pb10 fwm">
                        x, y, zごとの描画範囲を設定します。
                    </p>
                    <p class="pl0 pb10 fwm">
                        入力用のボックスはテキストボックなので、変更する場合は直接数値を入力します。
                        デフォルトはx, y, zとも -2～2 です。<a href="#p1">※註</a>
                    </p>
                    <p class="pl0 pb10 fwm">
                        変更後はスタートボタンを押すことで、再描画されます。
                    </p>
                    <p class="pl0 pb10 fwm">
                        zについては関数の値がレンジを超えた場合は、x-y面と平行な平面が描かれます。
                        これだと境界が分かりづらいのでz : max, 0, minの3ヶ所で等高線を描くことで、
                        境界を明確にしています。
                        次に説明するAngleの設定でgamma(上下の視点位置)を90度にセットすると
                        陰関数のグラフが描画されます。
                    </p>
                </div>

                <div class="pic-left720 fwb pb20">
                    <div class="contents-title-left pb20"
                        <p id="s4">
                            [4] Angleの設定
                        </p>
                    </div>
                    <div class="contents-title-right"
                        <p>
                            <!--<a href="#title20">トップへ</a>-->
                        </p>
                    </div>
                    <div class="c-both"></div>
                    <p class="pl0 pb10 fwm">
                        [alpha]は視点位置の水平方向(z軸廻り)の角度を設定します。
                        [gamma]は視点位置の上下方向の角度(俯角[-]/仰角[+])を設定します。
                        テクストボックスなので直接数値を入力することもできますが、
                        描画ウインドウ右のスライダーが[alpha]に、下のスライダーが[gamma]に連動しているので、
                        スライダーを動かすとそのときの角度が表示されます。
                        デフォルトは[alpha]:30度、[gamma]：-30度です。<a href="#p1">※註</a>
                    </p>
                    <p class="pl0 pb10 fwm">
                        変更後はスタートボタンを押すことで、再描画されます。
                    </p>
                </div>

                <div class="pic-left720 fwb pb20">
                    <div class="contents-title-left pb20"
                        <p id="s5">
                            リセットボタン
                        </p>
                    </div>
                    <div class="contents-title-right"
                        <p>
                            <!--<a href="#title20">トップへ</a>-->
                        </p>
                    </div>
                    <div class="c-both"></div>
                    <p class="pl0 pb10 fwm">
                        スライダーを動かすと、リセットボタンが使用できるようになります。
                        ボタンを押すと、Angleがデフォルトの角度に戻ります。
                        Mesh, Rangeで変更があった場合は、その変更は保持されます。
                    </p>
                </div>
                <div class="pic-left720 fwb pb50">
                    <p id="p1">※註 :</p> 選択された曲面によっては別の値がセットされている場合があります。
                </div>
            </div>


            <div class="pb30 fwb">
                <p>
                    [Ⅱ] セレクトボックスで選択できる曲面について簡単に説明したいと思います。
                </p>
            </div>
            <div class="pl20">
                <div class="fwb pb30">
                    <ul class="list_none fwm pb40, pl40">
                        <li class="pb10"><a href="#a1">[01] 関数諸例</a></li>
                        <li class="pb10"><a href="#a2">[02] 複素関数(絶対値)</a></li>
                        <li class="pb10"><a href="#a3">[03] 微分方程式 解曲線の描画 で取り上げた関数</a></li>
                        <li class="pb10"><a href="#a99">[99] ユーザー定義</a></li>
                    </ul>
                </div>

                <div class="pic-left720 fwb pb20">
                    <div class="contents-title-left pb20"
                        <p id="a1">
                            [01]&nbsp;関数諸例
                        </p>
                    </div>
                    <div class="contents-title-right"
                        <p>
                            <!--<a href="#title20">トップへ</a>-->
                        </p>
                    </div>
                    <div class="c-both"></div>
                    <p class="pl0 pb10 fwm">
                        つれづれなるままに増やしていった関数がストックされています。
                        なめらかな曲面は特に問題ないと思いますが、
                        不連続な曲面(分数で定義される関数の分母が0になる場合など)ではいわゆる0割が発生する可能性があります。
                    </p>
                    <p class="pl0 pb10 fwm">
                        Javascriptの仕様に従って、以下のように対処しています。
                    </p>
                    <p class="pl10 pb10 fwm">
                        正の実数 / 0.0 -> Infinity(仕様) -> 9999.0
                    </p>
                    <p class="pl10 pb10 fwm">
                        負の実数 / 0.0 -> -Infinity(仕様) -> -9999.0
                    </p>
                    <p class="pl10 pb10 fwm">
                        0.0 / 0.0 -> Nan(仕様) -> 0.0
                    </p>
                </div>

                <div class="pic-left720 fwb pb20">
                    <div class="contents-title-left pb20"
                        <p id="a2">
                            [02]&nbsp;複素関数(絶対値)
                        </p>
                    </div>
                    <div class="contents-title-right"
                        <p>
                            <!--<a href="#title20">トップへ</a>-->
                        </p>
                    </div>
                    <div class="c-both"></div>
                    <div class="fwb pb30">
                        <ol class="list_none pb40, pl40">
                            <li><a href="#02&01">[01] |sin(ω)|, ω = x + iy</a></li>
                            <li><a href="#02&02">[02] |cos(ω)|, ω = x + iy</a></li>
                            <li><a href="#02&03">[03] |Γ(ω)|, ω = x + iy</a></li>
                        </ol>
                    </div>

                    <ol class="fwm pb40, pl40">
                        <li class="pb40">
                            <p id="02&01"; class="pb10 fwb fss">
                                |sin(ω)|, ω = x + iy
                            </p>
                            <div class="contents-left pb10"
                                <p class="pb10">
                                    &emsp;
                                </p>
                            </div>
                            <div class="contents-right">
                                <p>
                                    <a href="etc_Pers_v1.html?selectedOption=02%2601">描画へ</a>
                                </p>
                            </div>
                            <div class="c-both"></div>
                            <div class="contents-left pb10"
                                <p class="pb10">
                                    $ \omega = x + iy $ とすると
                                </p>
                                <p class="pb10">
                                   $ sin(\omega) = \sin x \cosh y + i \cos x \sinh y $ より
                                </p>
                                <p class="pb10">
                                   $ |\sin(\omega)| = \sqrt{\sin^2 x \cosh^2 y + \cos^2 x \sinh^2 y} $
                                </p>
                            </div>
                            <div class="contents-right"
                                <p>
                                    <a href="etc_DEQ_v2.html?selectedOption=04%2601">
                                        <img src="image/pers/pers_v1_0201w_25.jpg" border="0">
                                    </a>
                                </p>
                            </div>
                            <div class="c-both"></div>
                            <p class="pb10">
                                実際の計算は$ |\sin(\omega)| $ の右辺の式を使っています。
                                x軸が実部、y軸が虚部に相当します。
                                後述する「ユーザー定義」で複素関数の絶対値を描画する場合は、
                                $ |\sin(\omega)| $ の右辺のように虚数$i$が消去された式を定義する必要があります。
                            </p>
                        </li>
                        <li class="pb40">
                            <p id="02&02"; class="pb10 fwb fss">
                                 |cos(ω)|, ω = x + iy
                            </p>
                            <div class="contents-left pb10"
                                &emsp;
                            </div>
                            <div class="contents-right"
                                <p>
                                    <a href="etc_Pers_v1.html?selectedOption=02%2602">描画へ</a>
                                </p>
                            </div>
                            <div class="c-both"></div>
                            <div class="contents-left pb10"
                                <p class="pb10">
                                    $ \omega = x + iy $ とすると
                                </p>
                                <p class="pb10">
                                   $ cos(\omega) = \cos x \cosh y + i \sin x \sinh y $ より
                                </p>
                                <p class="pb10">
                                   $ |\sin(\omega)| = \sqrt{\cos^2 x \cosh^2 y + \sin^2 x \sinh^2 y} $
                                </p>
                            </div>
                            <div class="contents-right"
                                <p>
                                    <a href="etc_DEQ_v2.html?selectedOption=04%2601">
                                        <img src="image/pers_img/pers_v1_0202_20.jpg" border="0">
                                    </a>
                                </p>
                            </div>
                            <div class="c-both"></div>
                            <p class="pb10">
                                $\sin$ が出たついでです。$\cos$ も実際の計算は$ |\cos(\omega)| $ の右辺の式を使っています。
                                x軸が実部、y軸が虚部に相当します。
                            </p>
                        </li>
                        <li class="pb40">
                            <p id="04&02"; class="pb10 fwb fss">
                                円周上に8つの平衡点を持つ自励形<br>
                            </p>
                            <div class="contents-left pb10"
                                <p class="pb10">
                                    例)
                                </p>
                            </div>
                            <div class="contents-right"
                                <p>
                                    <a href="etc_DEQ_v2.html?selectedOption=04%2602">描画へ</a>
                                </p>
                            </div>
                            <div class="c-both"></div>
                            <div class="contents-left pb10"
                                <p class="pb10">
                                    \[ \frac{dx}{dt} = x^2y^2 - 1 \]
                                    \[ \frac{dy}{dt} = x^2 + y^2 - a \]
                                </p>
                            </div>
                            <div class="contents-right"
                                <p>
                                    <a href="etc_DEQ_v2.html?selectedOption=04%2602">
                                        <img src="image/DEQ_img/deq2_0402_20.jpg" border="0">
                                    </a>
                                </p>
                            </div>
                            <div class="c-both"></div>
                            <p class="pb10">
                                この自励形は、円周
                                $x^2 + y^2 = a $ 上に8つの平衡点を持ちます。<br>
                                各象限に2つずつ計8個です。元々パラメーター$a$には固定値の 4 が与えられていましたが、
                                可変にしてみました。どのような解軌道が描かれるか、確認してみて下さい。
                                平衡点の位置が少し分かりづらいので、描画終了時に円を表示するようにしています。
                                デフォルトの描画範囲は 8 ですが、16 とか 32 にすると、
                                初期値をランダムに取っている関係で軌道は荒くなりますが、平衡点は確認し易くなると思います。
                            </p>
                        </li>
                        <li class="pb40">
                            <p id="04&03"; class="pb10 fwb fss">
                                平面上に周期的な平衡点を持つ自励形<br>
                            </p>
                            <div class="contents-left pb10"
                                <p class="pb10">
                                    例)
                                </p>
                            </div>
                            <div class="contents-right"
                                <p>
                                    <a href="etc_DEQ_v2.html?selectedOption=04%2603">描画へ</a>
                                </p>
                            </div>
                            <div class="c-both"></div>
                            <div class="contents-left pb10"
                                <p class="pb10">
                                    \[ \frac{dx}{dt} = \cos x + \cos y \]
                                    \[ \frac{dy}{dt} = \sin x \sin y \]
                                </p>
                            </div>
                            <div class="contents-right"
                                <p>
                                    <a href="etc_DEQ_v2.html?selectedOption=04%2603">
                                        <img src="image/DEQ_img/deq2_0403_20.jpg" border="0">
                                    </a>
                                </p>
                            </div>
                            <div class="c-both"></div>
                            <p class="pb10">
                                この自励形は
                                $
                                    \pmatrix{
                                        2p\pi \cr
                                        (2q + 1)\pi \cr
                                    }
                                    と \quad
                                    \pmatrix{
                                        (2p + 1)\pi \cr
                                        2q\pi \cr
                                    }
                                    に平衡点を持ちます(p, qは整数)。
                                $
                            </p>
                            <p class="pb10">
                                4-1と同様に、平衡点の近傍で1次近似を行うと、
                                1つ目のタイプの平衡点は双楕円型になります。<br>
                                2つ目のタイプの平衡点は3峠型になります。<br>
                                平面上で、これが繰り返されます。
                            </p>
                        </li>
                    </ol>
                </div>
            </div>

            <div class="pic-left720 fwb pb20">
                <div class="contents-title-left pb20"
                    <p id="a4">
                        [04]&nbsp;自励系の諸例
                    </p>
                </div>
                <div class="contents-title-right"
                    <p>
                        <!--<a href="#title20">トップへ</a>-->
                    </p>
                </div>
                <div class="c-both"></div>

                <div class="fwb pb30">
                    <ul class="list_none pb40, pl40">
                        <li><a href="#04&01">[01] x軸上に周期的に鞍状点と渦心点を持つ自励形</a></li>
                        <li><a href="#04&02">[02] 円周上に8つの平衡点を持つ自励形</a></li>
                        <li><a href="#04&03">[03] 平面上に周期的な平衡点を持つ自励形</a></li>
                        <li><a href="#04&04">[04] 極限軌道 1 &emsp; 解軌道が極限円になる場合</a></li>
                        <li><a href="#04&05">[05] 極限軌道 2 &emsp; von del Pol(ファン・デル・ポル)の自励形</a></li>
                        <li><a href="#04&06">[06] 極限軌道 3 &emsp; レムニスケート</a></li>
                        <li><a href="#04&07">[07] 極限軌道 4 &emsp; 線形近似が純虚数の場合 1</a></li>
                        <li><a href="#04&08">[08] 極限軌道 5 &emsp; 線形近似が純虚数の場合 2</a></li>
                        <li><a href="#04&09">[09] Hamilton型 1 &emsp; Cassini(カシニ)の燈形</a></li>
                        <li><a href="#04&10">[10] Hamilton型 2 &emsp; Descartes(デカルト)の葉線</a></li>
                        <li><a href="#04&11">[11] Hamilton型 3 &emsp; Descartes(デカルト)の葉線の派生形</a></li>
                        <li><a href="#04&12">[12] Hamilton型 4 &emsp; 三角関数の周期性が反映される例</a></li>
                    </ul>
                </div>

                <ol class="fwm pb40, pl40">
                    <li class="pb40">
                        <p id="04&01"; class="pb10 fwb fss">
                            x軸上に周期的に鞍状点と渦心点を持つ自励形<br>
                        </p>
                        <div class="contents-left pb10"
                            <p class="pb10">
                                例)
                            </p>
                        </div>
                        <div class="contents-right"
                            <p>
                                <a href="etc_DEQ_v2.html?selectedOption=04%2601">描画へ</a>
                            </p>
                        </div>
                        <div class="c-both"></div>
                        <div class="contents-left pb10"
                            <p class="pb10">
                                \[ \frac{dx}{dt} = y \]
                                \[ \frac{dy}{dt} = \sin x + y^2 \]
                            </p>
                        </div>
                        <div class="contents-right"
                            <p>
                                <a href="etc_DEQ_v2.html?selectedOption=04%2601">
                                    <img src="image/DEQ_img/deq2_0401_20.jpg" border="0">
                                </a>
                            </p>
                        </div>
                        <div class="c-both"></div>
                        <p class="pb10">
                            この自励形は<br>
                            $(p\pi, 0) \quad p = \pm1, \pm2, \ldots $ に平衡点を持つ。<br>
                            $p$ が偶数のときは、鞍状点となり、奇数のときは、渦心点になります。
                            全体としては、金魚が並んだような解曲線が描かれます。奇数の渦心点が金魚の目になり、
                            偶数の鞍状点が尻尾になります。
                        </p>
                        <p class="pb10">
                            森本氏の丁寧な解説を思いっきり端折ります。
                            それぞれの平衡点の近傍で、$\sin x$を級数展開し、$1次$で近似します。<br>
                            $p$ が偶数のときは$p = 0$とすれば$x = 0$の近傍では$\sin x \approx x$と近似できます。
                            $y^2$ も$x$に比べて十分に小さいとすれば、
                            方程式は以下のように表現できます。
                            \[ \frac{dx}{dt} = y \]
                            \[ \frac{dy}{dt} = x \]
                            これを線形近似といいます。対応する2次の正方行列の固有値は$\pm 1$ になるので、平衡点は鞍状点になります。
                            <a href="#01&02">[01] - 2 参照</a>
                        </p>
                        <p class="pb10">
                            $p$ が奇数のときは、$p = \pi$とすれば$x = \pi$の近傍では$\sin x \approx -(x - \pi)$と近似でき、
                            $x^2$ も$x - \pi$に比べて十分に小さいとすれば、
                            方程式は以下のように表現できます。
                            \[ \frac{dx}{dt} = y \]
                            \[ \frac{dy}{dt} = -(x - \pi) \]
                            $x - \pi, -y$を新しい座標とすれば、
                            \[ \frac{dx}{dt} = -y \]
                            \[ \frac{dy}{dt} = x  \]
                            対応する2次の正方行列の固有値は$\pm i$ になるので、平衡点は渦心点になります。
                            <a href="#01&08">[01] - 8 参照</a>
                        </p>
                        <p class="pb10">
                            それぞれの平衡点の近傍では上記の近似が成立し、離れるに連れて、
                            元々の方程式の項の影響が現れ、全体として、金魚が並んだような解軌道になると考えられます。
                        </p>
                    </li>
                    <li class="pb40">
                        <p id="04&02"; class="pb10 fwb fss">
                            円周上に8つの平衡点を持つ自励形<br>
                        </p>
                        <div class="contents-left pb10"
                            <p class="pb10">
                                例)
                            </p>
                        </div>
                        <div class="contents-right"
                            <p>
                                <a href="etc_DEQ_v2.html?selectedOption=04%2602">描画へ</a>
                            </p>
                        </div>
                        <div class="c-both"></div>
                        <div class="contents-left pb10"
                            <p class="pb10">
                                \[ \frac{dx}{dt} = x^2y^2 - 1 \]
                                \[ \frac{dy}{dt} = x^2 + y^2 - a \]
                            </p>
                        </div>
                        <div class="contents-right"
                            <p>
                                <a href="etc_DEQ_v2.html?selectedOption=04%2602">
                                    <img src="image/DEQ_img/deq2_0402_20.jpg" border="0">
                                </a>
                            </p>
                        </div>
                        <div class="c-both"></div>
                        <p class="pb10">
                            この自励形は、円周
                            $x^2 + y^2 = a $ 上に8つの平衡点を持ちます。<br>
                            各象限に2つずつ計8個です。元々パラメーター$a$には固定値の 4 が与えられていましたが、
                            可変にしてみました。どのような解軌道が描かれるか、確認してみて下さい。
                            平衡点の位置が少し分かりづらいので、描画終了時に円を表示するようにしています。
                            デフォルトの描画範囲は 8 ですが、16 とか 32 にすると、
                            初期値をランダムに取っている関係で軌道は荒くなりますが、平衡点は確認し易くなると思います。
                        </p>
                    </li>
                    <li class="pb40">
                        <p id="04&03"; class="pb10 fwb fss">
                            平面上に周期的な平衡点を持つ自励形<br>
                        </p>
                        <div class="contents-left pb10"
                            <p class="pb10">
                                例)
                            </p>
                        </div>
                        <div class="contents-right"
                            <p>
                                <a href="etc_DEQ_v2.html?selectedOption=04%2603">描画へ</a>
                            </p>
                        </div>
                        <div class="c-both"></div>
                        <div class="contents-left pb10"
                            <p class="pb10">
                                \[ \frac{dx}{dt} = \cos x + \cos y \]
                                \[ \frac{dy}{dt} = \sin x \sin y \]
                            </p>
                        </div>
                        <div class="contents-right"
                            <p>
                                <a href="etc_DEQ_v2.html?selectedOption=04%2603">
                                    <img src="image/DEQ_img/deq2_0403_20.jpg" border="0">
                                </a>
                            </p>
                        </div>
                        <div class="c-both"></div>
                        <p class="pb10">
                            この自励形は
                            $
                                \pmatrix{
                                    2p\pi \cr
                                    (2q + 1)\pi \cr
                                }
                                と \quad
                                \pmatrix{
                                    (2p + 1)\pi \cr
                                    2q\pi \cr
                                }
                                に平衡点を持ちます(p, qは整数)。
                            $
                        </p>
                        <p class="pb10">
                            4-1と同様に、平衡点の近傍で1次近似を行うと、
                            1つ目のタイプの平衡点は双楕円型になります。<br>
                            2つ目のタイプの平衡点は3峠型になります。<br>
                            平面上で、これが繰り返されます。
                        </p>
                    </li>
                    <li class="pb40">
                        <p id="04&04"; class="pb10 fwb fss">
                            極限軌道の例 1<br>
                            解軌道が極限円になる場合
                        </p>
                        <div class="contents-left pb10"
                            <p class="pb10">
                                例)
                            </p>
                        </div>
                        <div class="contents-right"
                            <p>
                                <a href="etc_DEQ_v2.html?selectedOption=04%2604">描画へ</a>
                            </p>
                        </div>
                        <div class="c-both"></div>
                        <div class="contents-left pb10"
                            <p class="pb10">
                                \[ \frac{dx}{dt} = ay + ax(1 - x^2 - y^2) \]
                                \[ \frac{dy}{dt} = cx + dy(1 - x^2 - y^2) \]
                            </p>
                        </div>
                        <div class="contents-right"
                            <p>
                                <a href="etc_DEQ_v2.html?selectedOption=04%2604">
                                    <img src="image/DEQ_img/deq2_0404_20.jpg" border="0">
                                </a>
                            </p>
                        </div>
                        <div class="c-both"></div>
                        <p class="pb10">
                            パラメーター$ a, b, c, d $ には以下の値が与えられています。
                        </p>
                        <p class="pb10">
                            $ a = 1, \, b = 1, \, c = -1 , \, d = 1 $
                        </p>
                        <p class="pb10">
                            極限軌道はPoincaré (ポアンカレ) によって導入されました。
                            この例では極限軌道は $x^2 + y^2 = 1$になり、極限円になります。
                            初期値が円の外側にある場合も内側にある場合も、円に螺旋状に巻きついて行きます。
                            この極限円は安定であるといえます。
                        </p>
                        <p class="pb20">
                            極限円については森本氏が結構詳しく解説されているのですが、私自身は理解できる状態に至っていません。
                            森本氏は
                            <a href="https://www.asakura.co.jp/detail.php?book_code=11415" target="_blank">"笠原皓司 微分方程式の基礎 朝倉書店 1982"</a>
                            を参考にすることを勧められています。
                        </p>
                        <p class="pb10">
                            さて、パラメーター$ a, b, c, d $ に以下の値をセットしてみて下さい。
                            解軌道の様相が一変します。
                        </p>
                        <p class="pb10">
                            $ a = -1, \, b = -1, \, c = 1 , \, d = -1 $
                        </p>
                        <p class="pb15">
                            今度も極限軌道は $x^2 + y^2 = 1$になりますが、
                            円の内側の解軌道は螺旋状に原点に向かい、
                            円の外側の解軌道は螺旋状に円から離れて無限大に向かいます。
                            従って、極限円は不安定です。
                        </p>
                        <p class="pl0 pl0 pb10">
                            極限軌道については、下記のサイトを参照してください。
                            次に紹介する予定の "von del Polの自励形" も含めて、詳しく解説されています。
                        </p>
                        <p class="pl0 pl0 pb10">
                              1. <a href="https://ja.wikipedia.org/wiki/%E3%83%AA%E3%83%9F%E3%83%83%E3%83%88%E3%82%B5%E3%82%A4%E3%82%AF%E3%83%AB#%E5%85%B7%E4%BD%93%E4%BE%8B"
                              target="_blank">リミットサイクル</a>
                        </p>
                        <p class="pl0 pl0 pb10">
                            "ポアンカレ 極限円 etc." で検索をかけていくと、"だまし絵で有名な Escher (エッシャー) が深く関係していることが見えてきます。
                        </p>
                        <p class="pl0 pl0 pb10">
                              2. <a href="https://ja.wikipedia.org/wiki/%E3%83%9D%E3%83%AF%E3%83%B3%E3%82%AB%E3%83%AC%E3%81%AE%E5%86%86%E6%9D%BF%E3%83%A2%E3%83%87%E3%83%AB"
                              target="_blank">ポワンカレの円板モデル</a>
                        </p>
                        <p class="pl0 pl0 pb10">
                            こちらは幾何についての考察なのですが、何がどう絡んでいるのか...まさにカオスです。
                        </p>
                    </li>
                    <li class="pb40">
                        <p id="04&05"; class="pb10 fwb fss">
                            極限軌道の例 2 von del Pol(ファン・デル・ポル)の自励形<br>
                        </p>
                        <div class="contents-left pb10"
                            <p class="pb10">
                                例)
                            </p>
                        </div>
                        <div class="contents-right"
                            <p>
                                <a href="etc_DEQ_v2.html?selectedOption=04%2605">描画へ</a>
                            </p>
                        </div>
                        <div class="c-both"></div>
                        <div class="contents-left pb10"
                            <p class="pb10">
                                \[ \frac{dx}{dt} = y \]
                                \[ \frac{dy}{dt} = -x + ay(1 - x^2) \]
                            </p>
                        </div>
                        <div class="contents-right"
                            <p>
                                <a href="etc_DEQ_v2.html?selectedOption=04%2605">
                                    <img src="image/DEQ_img/deq2_0405_20.jpg" border="0">
                                </a>
                            </p>
                        </div>
                        <div class="c-both"></div>
                        <p class="pb10">
                            デフォルトではパラメーター$ a $ には 1 がセットされています。
                        </p>
                        <p class="pb10">
                            ファン・デル・ポルの方程式は様々なサイトで紹介されていますが、
                            [04] - 4 で参照先として紹介した
                            <a href="https://ja.wikipedia.org/wiki/%E3%83%AA%E3%83%9F%E3%83%83%E3%83%88%E3%82%B5%E3%82%A4%E3%82%AF%E3%83%AB#%E5%85%B7%E4%BD%93%E4%BE%8B"
                            target="_blank">リミットサイクル</a>
                            が分かりやすいと思います。
                            極限軌道は、円とはとてもいえないひしゃげた四角形に見えますが、
                            この方程式も、極限円の性質を備えているとのことです。
                            パラメーター $a$ を0.9, 0.8…と小さくして描画を実行すると、次第に円に近づいていくのが分かると思います。
                            このケースの解軌道も安定です。
                        </p>
                        <p class="pb10">
                            $ a = 0$ の場合、原点は2次元1次の線形自励形で紹介した渦心点 ( [01] - 8 ) になります。
                            更に、$a$ が負になるとどうなるでしょうか？ 確認してみて下さい！
                        </p>
                    </li>
                    <li class="pb40">
                        <p id="04&06"; class="pb10 fwb fss">
                            極限軌道の例 3 Lemniscate(レムニスケート)<br>
                        </p>
                        <div class="contents-left pb10"
                            <p class="pb10">
                                例)
                            </p>
                        </div>
                        <div class="contents-right"
                            <p>
                                <a href="etc_DEQ_v2.html?selectedOption=04%2606">描画へ</a>
                            </p>
                        </div>
                        <div class="c-both"></div>
                        <div class="contents-left pb10"
                            <p class="pb10">
                                \[ \frac{dx}{dt} = a * y(1 + 2x^2 + 2y^2) \]
                                \[ \frac{dy}{dt} = b * x(1 - 2x^2 - 2y^2) + c * y(1 + 2x^2 + 2y^2)((x^2 + y^2)^2 - (x^2 - y^2)) \]
                            </p>
                        </div>
                        <div class="contents-right"
                            <p>
                                <a href="etc_DEQ_v2.html?selectedOption=04%2606">
                                    <img src="image/DEQ_img/deq2_0406_20.jpg" border="0">
                                </a>
                            </p>
                        </div>
                        <div class="c-both"></div>
                        <p class="pb10">
                            デフォルトではパラメーター$ a, b $ には 1 が、$c$ には -1 がセットされています。
                        </p>
                        <p class="pb10">
                            この自励形の平衡点は3つあり、原点 (鞍状点) と2つの安定な渦状点 ($ \pm 1 / \sqrt{2}, 0 $) である。
                        </p>
                        <p class="pb10">
                            <a href="etc_DEQ_IF_v2.html?selectedOption=04%2606">レムニスケート</a>
                            と呼ばれる曲線 $ (x^2 + y^2)^2 - (x^2 - y^2) = 0 $ に、3つの極限軌道が存在する。
                            原点は平衡点で、$x < 0$ と$ x > 0$ の部分が方程式の解軌道になる。
                            森本氏によると、これらは極限円ではないとのこと。
                            これは2つの極限軌道が連結しているためと思われます。極限軌道自体は安定です。
                        </p>
                        <p class="pb10">
                            $ a = -1, b = -1, c = 1$ の場合はどうなるでしょうか？
                            確認してみて下さい！
                        </p>
                        <p class="pb10">
                            $ a = -1, b = 1, c = -1$ の場合はどうなるでしょうか？
                            3つの平衡点が原点 (渦状点) と2つの鞍状点 ($ \pm 1 / \sqrt{2}, 0 $) に変わります。
                            レムニスケートではなくなり、原点を中心に人の目のような軌道が現れます。<br>
                            $ a = 1, b = -1, c = 1$ では軌道の向きが反転します。
                        </p>
                    </li>
                    <li class="pb40">
                        <p id="04&07"; class="pb10 fwb fss">
                            極限軌道の例 4 線形近似が純虚数の場合 1<br>
                            極限円が存在しない場合
                        </p>
                        <div class="contents-left pb10"
                            <p class="pb10">
                                例)
                            </p>
                        </div>
                        <div class="contents-right"
                            <p>
                                <a href="etc_DEQ_v2.html?selectedOption=04%2607">描画へ</a>
                            </p>
                        </div>
                        <div class="c-both"></div>
                        <div class="contents-left pb10"
                            <p class="pb10">
                                \[ \frac{dx}{dt} = y \]
                                \[ \frac{dy}{dt} = -x - y^3 \]
                            </p>
                        </div>
                        <div class="contents-right"
                            <p>
                                <a href="etc_DEQ_v2.html?selectedOption=04%2607">
                                    <img src="image/DEQ_img/deq2_0407_20.jpg" border="0">
                                </a>
                            </p>
                        </div>
                        <div class="c-both"></div>
<!--
                        <p class="pb10">
                            デフォルトではパラメーター$ a, b $ には 1 が、$c$ には -1 がセットされています。
                        </p>
-->
                        <p class="pb10">
                            この自励形の平衡点は原点のみである。
                        </p>
                        <p class="pb10">
                            原点で線形化(
                            <a href="#04&01">線形近似</a>
                            )すると、式は以下のようになる。
                        </p>
                        <p class="pb10">
                            \[ \frac{dx}{dt} = y \]
                            \[ \frac{dy}{dt} = -x \]
                        </p>
                        <p class="pb10">
                            固有値は $\lambda = \pm i$ になり、
                            解軌道は <a href="#01&08">[1] - 8</a> で見たように渦心点になる。
                        </p>
                        <p class="pb10">
                            ところが、実際に元の非線形の方程式の解軌道をプロットしてみると、渦心点ではなく渦状点らしき軌道が現れる。
                        </p>
                        <p class="pb10">
                            この軌道についての森本氏の説明を要約すると次のようになる。
                        </p>
                        <p class="pb10">
                            原点Oを中心とする半径 $r$ の円周のy切片をA, Bとする。
                            この円周上の各点で
                            $
                                ベクトル
                                \pmatrix{
                                    y \cr
                                    -x - y^3 \cr
                                }
                                は \quad 円周に接するベクトル
                                \pmatrix{
                                    y \cr
                                    -x \cr
                                }
                                と \quad 円の内側を向いているベクトル
                                \pmatrix{
                                    0 \cr
                                    -y^3 \cr
                                }
                                の和になるので、
                            $ <br>
                            円の内側を向いている。
                        </p>
                        <p class="pb10">
                            y軸上の点Aを通る解軌道は、Aより円周の内部に入り込み、
                            y軸上の点Bよりも原点Oに近いB'を横切る。
                            同じ議論をy軸上の点B'に置き換えると、
                            B'を通る解軌道は、B'より円周の内部に入り込み、
                            y軸上の点A'を横切る。
                        </p>
                        <p class="pb10">
                            <img src="image/DEQ_img/deq2_0407_fig.jpg" width="50%" height="50%" border="0">
                        </p>
                        <p class="pb20">
                            こうして、Aを通る解軌道は原点の回りを螺旋状にぐるぐると回り閉じることなく
                            原点に収束する。
                        </p>
                        <p class="pb10">
                            ただし、原点近傍では軌道の動きが鈍くなり、
                            "刻み幅"を小さくして、"繰返し"を増やさないと
                            予測通りの軌道がプロットされなくなるので、確認の際は注意すること。
                        </p>
                    </li>
                    <li class="pb40">
                        <p id="04&08"; class="pb10 fwb fss">
                            極限軌道の例 4 線形近似が純虚数の場合 2<br>
                            極限円が無限個現れる例
                        </p>
                        <div class="contents-left pb10"
                            <p class="pb10">
                                例)
                            </p>
                        </div>
                        <div class="contents-right"
                            <p>
                                <a href="etc_DEQ_v2.html?selectedOption=04%2608">描画へ</a>
                            </p>
                        </div>
                        <div class="c-both"></div>
                        <div class="contents-left pb10"
                            <p class="pb10">
<!--
                            \[ \frac{dx}{dt} = -y + 5x \, e^{(-1 / \sqrt{r})} \sin(1 / r)\]
                            \[ \frac{dy}{dt} = x + 5y \, e^{(-1 / \sqrt{r})} \sin(1 / r)\]
-->
                            \[ \frac{dx}{dt} = -y + 10x \, e^{(-1 / \sqrt{r})} \sin(1 / r)\]
                            \[ \frac{dy}{dt} = x + 10y \, e^{(-1 / \sqrt{r})} \sin(1 / r)\]
                            $\qquad$ where $\; r = \sqrt{x^2 + y^2} $
                            </p>
                        </div>
                        <div class="contents-right"
                            <p>
                                <a href="etc_DEQ_v2.html?selectedOption=04%2608">
                                    <img src="image/DEQ_img/deq2_0408_20.jpg" border="0">
                                </a>
                            </p>
                        </div>
                        <div class="c-both"></div>
<!--
                        <p class="pb10">
                            デフォルトではパラメーター$ a, b $ には 1 が、$c$ には -1 がセットされています。
                        </p>
-->
                        <p class="pb10">
                            $r$ は原点からの距離である。この方程式を(4.8.a)と呼ぶことにする。
                        </p>
                        <p class="pb10">
                            \[ \alpha(r) = \cases{
                                e^{(-1 / \sqrt{r})} \sin(1 / r) & ($r > 0$) \cr
                                0 & ($r = 0$) \cr
                            } \]
                        </p>
                        <p class="pb10">
                            $\alpha(r)$ で定義される関数は原点に近づくに連れて減衰振動を繰り返す曲線である。
                        </p>
                        <p class="pb10">
                            <img src="image/DEQ_img/deq2_0408_alpha_of_r_2.jpg" width="50%" height="50%" border="0">
                        </p>
                        <p class="pb10">
                            添付の図が荒くて分かり難いが、
                            $r$のステップを小さくして、図を引き延ばせば、フラクタルであることが推察できる。
                        </p>
                        <p class="pb10">
                            $\alpha(r) = 0$ となる(グラフが横軸と交わる)位置に注目する。
                            後ほど触れるが、交点の座標は右側から原点に向かって$1 / \pi, 1 / 2\pi, 1 / 3\pi, 1 / 4\pi, 1 / 5\pi...$と続く。<br>
                            $1 / \pi ～ 1 / 2\pi$ の間では、$\alpha(r) < 0$ である。<br>
                            $1 / 2\pi ～ 1 / 3\pi$ の間では、$\alpha(r) > 0$ である。<br>
                            $1 / 3\pi ～ 1 / 4\pi$ の間では、$\alpha(r) < 0$ である。<br>
                            $1 / 4\pi ～ 1 / 5\pi$ の間では、$\alpha(r) > 0$ である。<br>
                            ...
                        </p>
                        <p class="pb10">
                            $\alpha(r) = 0$の場合、方程式(8.4.a)は右辺第2項がそれぞれ消えるので、線形自励形
                        </p>
                        <p class="pb10">
                            \[ \frac{dx}{dt} = -y \]
                            \[ \frac{dy}{dt} = x \]
                        </p>
                        <p class="pb10">
                            と等しくなる。この方程式を(8.4.b)と呼ぶことにする。
                        </p>
                        <p class="pb10">
                            固有値は $\lambda = \pm i$ になり、
                            解軌道は <a href="#01&08">[1] - 8</a> で見たように渦心点になる。
                        </p>
                        <p class="pb10">
                            従って、方程式(4.8.a)は原点を中心とする半径 $r = 1 / k\pi\quad(ただし、kは自然数)$ の円周上では、
                            線形化した方程式(4.8.b)と一致した閉じた解軌道(極限円)を持つ。
                        </p>
                        <p class="pb10">
                            $k$ は自然数であるから、閉じた解軌道は無限に存在することになるが、
                            軌道は半径 $1 / \pi$ の円周の内側に出現する。
                        </p>
                        <p class="pb10">
                            では、方程式(8.4.a)の初期値が円周 $1 / k\pi$ 上にない場合の解軌道は、どうなるだろうか？
                            方程式(8.4.a)から右辺第1項を消去した方程式(8.4.c)は
                        </p>
                            <p class="pb10">
                            \[ \frac{dx}{dt} = 10x \, e^{(-1 / \sqrt{r})} \sin(1 / r)\]
                            \[ \frac{dy}{dt} = 10y \, e^{(-1 / \sqrt{r})} \sin(1 / r)\]
                            $\qquad$ where $\; r = \sqrt{x^2 + y^2} $
                            </p>
                        <p class="pb10">
                            と表される。(8.4.c)から指数部分以降を省くと線形自励形となり
                            <a href="#01&06">[1] - 6</a> で見たように原点から放射状に伸びる半直線である。
                            では、(8.4.c)自体はどのようになるだろうか？
                        </p>
                        <p class="pb10">
                            (8.4.c)のベクトル場を示すと以下のようになる。
                        </p>
                        <p class="pb10">
                            <img src="image/DEQ_img/deq2_0408_alpha_of_r_vec.jpg" width="75%" height="75%" border="0">
                        </p>
                        <p class="pb10">
                            ベクトル場のグラフは各線分の向きを矢印ではなく、赤色のドットで代用している。
                            ベクトルは放射状であるが、$\alpha(r) = 0$ となる円周 $r = 1 / k\pi$ を境に向きが変わるのが確認できると思う。
                            一番外側の黄色の円周を例に取ると、円周の外側の各点(Mとする)は原点から放射状に遠ざかるベクトルである。
                            黄色の円周と1つ内側の青色の円周までの各点(Nとする)は、放射状に原点に向かうベクトルである。
                        </p>
                        <p class="pb10">
                            話を方程式(8.4.a)に戻す。
                            方程式(8.4.a)において、黄色の円周より外側の点Mのベクトルは、
                            原点から点Mまでの距離を半径とする円に沿ったベクトルと原点から放射状に遠ざかるベクトルの和である。
                            解軌道は、円周に沿いながら離れていく軌道になる。<br>
                            一方、黄色の円周と1つ内側の青色の円周間の点Nのベクトルは、
                            原点から点Nまでの距離を半径とする円に沿ったベクトルと放射状に原点に向かうベクトルの和である。
                            解軌道は、青色の円周に沿って向かいながら、やがて青色の円周に巻き付いて行く軌道になる。<br>
                            更に、青色の円周からその内側の黄色の円周までの各点は、
                            原点から点までの距離を半径とする円に沿ったベクトルと放射状に外側に向かうベクトルの和になるので、
                            解軌道は、青色の円周に沿って向かいながら、やがて青色の円周に巻き付いて行く軌道になる。
                        </p>
                        <p class="pb10">
                            原点に近づくに連れて、円周 $1 / k\pi$ は無限に出現するが、
                            上記の説明の繰返しになるため、$k$が奇数の場合、極限円は不安定となり、
                            偶数の場合は安定となる。
                        </p>
                    </li>

                    <li class="pb40">
                        <p id="04&09"; class="pb10 fwb fss">
                            Hamilton型の例 1&emsp; Cassini(カシニ)の燈形
                        </p>
                        <div class="contents-left pb10"
                            <p class="pb10">
                                例)
                            </p>
                        </div>
                        <div class="contents-right"
                            <p>
                                <a href="etc_DEQ_v2.html?selectedOption=04%2609">描画へ</a>
                            </p>
                        </div>
                        <div class="c-both"></div>
                        <div class="contents-left pb10"
                            <p class="pb10">
                            \[ \frac{dx}{dt} = y(1 + x^2 + y^2)\]
                            \[ \frac{dy}{dt} = x(1 - x^2 - y^2)\]
                            </p>
                        </div>
                        <div class="contents-right"
                            <p>
                                <a href="etc_DEQ_v2.html?selectedOption=04%2609">
                                    <img src="image/DEQ_img/deq2_0409_20.jpg" border="0">
                                </a>
                            </p>
                        </div>
                        <div class="c-both"></div>
<!--
                        <p class="pb10">
                            デフォルトではパラメーター$ a, b $ には 1 が、$c$ には -1 がセットされています。
                        </p>
-->
                        <p class="pb10">
                            ハミルトン型の方程式は以下の特徴を持つ。
                        </p>
                        <p class="pb10">
                            \[ \frac{dx}{dt} = F_y(x, y)\]
                            \[ \frac{dy}{dt} = -F_x(x, y)\]
                            \[ 解析解は、以下の陰関数となる \]
                            \[ F(x, y) = C\]
                        </p>
                        <p class="pb10">
                            解析解が陰関数となるので、直接、一般解を求積しても、描画は以外とやっかいである。
                            媒介変数を使って表示するという手もありだが、関数に手を加えず描きたいと横着な考え方をすると、
                            描画エリアを格子状に分割して、各格子の4辺と関数が交わるか調べながら
                            近似的にグラフをプロットしていくというのが、簡単な方法ではないかと思う。
                        </p>
                        <p class="pb30">
                            微分方程式の解軌道は、解析解の曲線族をプロットすることになるので、
                            Hamilton型の場合は、ダイレクトに陰関数のグラフを描画することになる。
                        </p>
                        <p class="pb10">
                            Cassiniの燈形の解析解は以下の通りである。
                        </p>
                        <p class="pb10">
                            \[ F(x, y) = \frac{1}{4}(1 + x^2 + y^2)^2 - x^2 = C\]
                        </p>
                        <p class="pb10">
                            平衡点は原点と、$(\pm1, 0)$の3点である。原点は鞍状点になり、$(\pm1, 0)$は渦心点となる。
                        </p>
                        <p class="pb10">
                            実際にプロットしてみると、解軌道は全て周期解である。
                            陰関数のグラフ
                            <a href="etc_DEQ_IF_v2.html?selectedOption=04%2609">Cassiniの燈形</a>
                            と一致することが確認できる。
                        </p>
                        <p class="pb10">
                            陰関数のグラフの定数が0.25のとき、レムニスケートになる。
                            <a href="#04&06">[4] - 6</a> でレムニスケートを紹介したが、一般解は極限軌道であったことが大きく異なる。
                        </p>
                    </li>
                    <li class="pb40">
                        <p id="04&10"; class="pb10 fwb fss">
                            Hamilton型の例 2&emsp; Descartes(デカルト)の葉線
                        </p>
                        <div class="contents-left pb10"
                            <p class="pb10">
                                例)
                            </p>
                        </div>
                        <div class="contents-right"
                            <p>
                                <a href="etc_DEQ_v2.html?selectedOption=04%2610">描画へ</a>
                            </p>
                        </div>
                        <div class="c-both"></div>
                        <div class="contents-left pb10"
                            <p class="pb10">
                            \[ \frac{dx}{dt} = 2x - 3y^2\]
                            \[ \frac{dy}{dt} = -2y + 3x^2\]
                            </p>
                        </div>
                        <div class="contents-right"
                            <p>
                                <a href="etc_DEQ_v2.html?selectedOption=04%2610">
                                    <img src="image/DEQ_img/deq2_0410_20.jpg" border="0">
                                </a>
                            </p>
                        </div>
                        <div class="c-both"></div>
                        <p class="pb10">
                            解析解は以下の通りである。
                        </p>
                        <p class="pb10">
                            \[ F(x, y) = -x^3 + 2xy - y^3 = C\]
                        </p>
                        <p class="pb10">
                            平衡点は原点と、$(2/3, 2/3)$の2点である。原点は鞍状点になり、$(2/3, 2/3)$は渦心点となる。
                        </p>
                        <p class="pb10">
                            <a href="etc_DEQ_IF_v2.html?selectedOption=04%2610">陰関数のグラフ</a>
                            で定数が0の場合、デカルトの正葉線がプロットされる。
                        </p>
                    </li>
                    <li class="pb40">
                        <p id="04&11"; class="pb10 fwb fss">
                            Hamilton型の例 3&emsp; Descartes(デカルト)の葉線の派生形
                        </p>
                        <div class="contents-left pb10"
                            <p class="pb10">
                                例)
                            </p>
                        </div>
                        <div class="contents-right"
                            <p>
                                <a href="etc_DEQ_v2.html?selectedOption=04%2611">描画へ</a>
                            </p>
                        </div>
                        <div class="c-both"></div>
                        <div class="contents-left pb10"
                            <p class="pb10">
                            \[ \frac{dx}{dt} = 2x^2 - 5y^4\]
                            \[ \frac{dy}{dt} = -4xy + 5x^4\]
                            </p>
                        </div>
                        <div class="contents-right"
                            <p>
                                <a href="etc_DEQ_v2.html?selectedOption=04%2611">
                                    <img src="image/DEQ_img/deq2_0411_20.jpg" border="0">
                                </a>
                            </p>
                        </div>
                        <div class="c-both"></div>
                        <p class="pb10">
                            解析解は以下の通りである。
                        </p>
                        <p class="pb10">
                            \[ F(x, y) = -x^5 + 2x^2y - y^5 = C\]
                        </p>
                        <p class="pb10">
                            平衡点は原点と、第1, 3象限(それぞれ点対称の関係)の3点である。原点は鞍状点になり、1, 3象限は渦心点となる。
                        </p>
                        <p class="pb10">
                            <a href="etc_DEQ_IF_v2.html?selectedOption=04%2611">陰関数のグラフ</a>
                            で定数が0の場合、デカルトの正葉線を2つ組み合わせたような曲線がプロットされる。
                        </p>
                        <p class="pb10">
                            <!--解軌道と、陰関数のグラフから$F(x, y)$がどのような曲面であるのか、何となく思い描けたが、-->
                            確認のために、曲面$F(x, y)$のグラフを描くと以下のようになる。
                            陰関数のグラフが曲面の等高線になっていることが分かる。
                        </p>
                        <p class="pb10">
                            <img src="image/DEQ_img/deq2_0411_kyokumen.jpg" border="0">
                        </p>
                    </li>
                    <li class="pb40">
                        <p id="04&12"; class="pb10 fwb fss">
                            Hamilton型の例 4&emsp; 三角関数の周期性が反映される例
                        </p>
                        <div class="contents-left pb10"
                            <p class="pb10">
                                例)
                            </p>
                        </div>
                        <div class="contents-right"
                            <p>
                                <a href="etc_DEQ_v2.html?selectedOption=04%2612">描画へ</a>
                            </p>
                        </div>
                        <div class="c-both"></div>
                        <div class="contents-left pb10"
                            <p class="pb10">
                                \[ \frac{dx}{dt} = \sin(y)\]
                                \[ \frac{dy}{dt} = \sin(x)\]
                            </p>
                        </div>
                        <div class="contents-right"
                            <p>
                                <a href="etc_DEQ_v2.html?selectedOption=04%2612">
                                    <img src="image/DEQ_img/deq2_0412_20.jpg" border="0">
                                </a>
                            </p>
                        </div>
                        <div class="c-both"></div>
                        <p class="pb10">
                            解析解は以下の通りである。
                        </p>
                        <p class="pb10">
                            \[ F(x, y) = \cos(y) - \cos(x) = C\]
                        </p>
                        <p class="pb10">
                            平衡点は $(p\pi, q\pi)$ である($p,q$ は整数)。
                            $p + q$ が偶数のときは鞍状点になり、奇数のときは渦心点になる。
                        </p>
                        <p class="pb10">
                            <a href="etc_DEQ_IF_v2.html?selectedOption=04%2612">陰関数のグラフ</a>
                            からは、$p + q$ が奇数で、$p$ が奇数のときは凸の等高線になり、
                            $p$が偶数のときは凹の等高線になることを示している。
                        </p>
                        <p class="pb10">
                            曲面$F(x, y)$のグラフを描くと以下のようになる。
                            これ、台所で見かける何かに似ていると思いませんか？
                        </p>
                        <p class="pb10">
                            <img src="image/DEQ_img/deq2_0412_kyokumen.jpg" border="0">
                        </p>
                  </li>
                </ol>
            </div>

            <div class="pic-left720 fwb pb20">
                <div class="contents-title-left pb20"
                    <p id="09&090"></p>
                    <p id="a99">
                        [99]&nbsp;ユーザー定義
                    </p>
                </div>
                <div class="contents-title-right"
                    <p>
                        <!--<a href="#title20">トップへ</a>-->
                    </p>
                </div>
                <div class="c-both"></div>

                <p class="pb20">
                    [描画へ]をクリックすると、以下の画面が表示されます。
                    任意の方程式を入力して、その解軌道を確認することができます。
                    STARTボタンを押すと入力ボックスの下に入力した式がTeX形式で表示され、描画が開始されます。
                    入力された式の評価には<a href="https://mathjs.org/docs/" target="_blank"> Math.js </a>を利用しています。
                    エラーメッセージが表示された場合は、入力した式を確認して、適宜修正して下さい。<br>
                    入力できる方程式は自励形に限ります(非自励形については、現在確認中)。
                </p>
                <p class="pb10">
                    <a href="etc_DEQ_v2.html?selectedOption=09%26090">
                        <img src="image/DEQ_img/deq4_page_75.jpg" border="1">
                    </a>
                </p>
                <p class="pb30">
                    以下に、入力例を示します。
                </p>
                <ol class="fwm pb40, pl40">
                    <li class="pb40">
                        <p id="09&091"; class="pb10">
                            2次元1次線形自励系の例です。
                        </p>
                        <p>
                          <a href="etc_DEQ_v2.html?selectedOption=09%26091">
                              <img src="image/DEQ_img/deq4_case1a.jpg">
                          </a>
                        </p>
                    </li>
                    <li class="pb40">
                        <p id="09&092"; class="pb10">
                            連立方程式にする必要がない場合の例です。$dx/dt$ を1とします。
                        </p>
                        <p>
                            <a href="etc_DEQ_v2.html?selectedOption=09%26092">
                                <img src="image/DEQ_img/deq4_case2a.jpg">
                            </a>
                        </p>
                    </li>
                    <li class="pb40">
                        <p id="09&093"; class="pb10">
                            べき乗は様々な入力が可能ですが、単純なものであれば、x^2で十分です。勿論、x*xでもよいです。
                            2乗くらいならx*xで問題ないですが、4乗、5乗となってくるとx^4などの方が入力が楽です。<br>
                            pow()も使えます。
                            pow(x^2 + y^2, 2)などはTeXで表示したとき、$(x^2 + y^2)^2$と表示されるので違和感がありませんが、
                            pow(x, 5)と入力すると、表示は$(y)^5$となります。計算自体は正しく実行されるので問題はないのですが、
                            違和感を感じられる場合は、単純にy^5と入力して下さい。
                        </p>
                        <p>
                            <a href="etc_DEQ_v2.html?selectedOption=09%26093">
                                <img src="image/DEQ_img/deq4_case3a.jpg">
                            </a>
                        </p>
                    </li>
                    <li class="pb40">
                        <p id="09&094"; class="pb10">
                            式が長くなる場合は、以下のように折り返して入力できます(ただし、異常に長い場合は画面のレイアウトが崩れます。
                            崩れても計算に影響はありませんが、非常に見づらくなります)。
                            また、式の一部が繰り返されるときは、where, $r = $ の入力ボックスに式を入力して、
                            方程式で繰り返される部分をrで置換することで、入力の手間を省くことができます。<br>
                            必要ない場合は、1.～3.のように何も入力する必要はありません。

                        </p>
                        <p>
                            <a href="etc_DEQ_v2.html?selectedOption=09%26094">
                                <img src="image/DEQ_img/deq4_case4a.jpg">
                            </a>
                        </p>
                    </li>
                    <li class="pb40">
                        <p id="09&095"; class="pb10">
                            入力された数式の解析はmath.jsを利用しているため、
                            pow()も含めて、sin(), cos()などの数学関数はそのまま入力できます。<br>
                            逆に、入力ボックスにmath.pow(), math.sin(), math.cos()などを含めた数式が入力された場合は、
                            エラーになり、描画は実行されません。<br>
                            指数については、e^xは$e^x$として評価されます。
                            exp(x)と入力した場合も、TeXの表示は$\exp(x)$になりますが、同じように評価されます。
                            指数部が複雑な場合はe^(x + 1)或いはexp(x + 1)のように括弧をつけて下さい。
                        </p>
                        <p>
                            <a href="etc_DEQ_v2.html?selectedOption=09%26095">
                                <img src="image/DEQ_img/deq4_case5a.jpg">
                            </a>
                        </p>
                    </li>
                </ol>
            </div>

            <!-- 補足説明 -->
            <div class="bd15 fwb">
                == 注釈 ==
            </div>
            <div class="bdr10 left fss pb10" style="width:760px">
                <p id="*1">
                    [1.]
                </p>
                <p>
                    このページでは、Local Storageを利用してセレクトボックスで選択されたリストの位置を保持する機能を持ちます。
                    選択項目の数が相当な量のため、ブラウザの更新ボタンが押された場合や、ページを閉じた後に再度ページを開いたとき、
                    いちいち先頭のリストから目的のリストまで辿るのは大変です。
                </p>
                <p class="pb10">
                    そこで、以下に示すように選択されたリストの位置を保持するためのチェックボックスを設置しました。
                </p>
                <p class="pb10">
                    <img src="image/DEQ_img/deq4_LocalStorage00.jpg">
                </p>
                <p>
                    チェックを入れてから特定の項目を選択すると、
                    Local StorageにチェックボックスのON/OFFと選択されたリストの番号が保存されます。
                    ブラウザの更新ボタンの押下やページを閉じてもデータが保存されるため、
                    ページが表示されると同時に目的の項目が選択された状態になります。
                </p>
                <p>
                    ただし、チェックを外すとLocal Storageに保存されていたデータは、keyと共に削除されるため、
                    ブラウザの更新ボタンが押された場合や、ページを閉じた後に再度ページを開いたとき、リストの先頭が選択された状態に戻ります。
                </p>
                <p>
                    Local Storageに保存されるデータ ( key, vakue ) は次の2点です。
                </p>
                <p>
                    <table class="pb10">
                      <tr><th>key</th><th>value</th></tr>
                      <tr><td>kzDeq_StorageFlg</td><td>"true" or "false"</td></tr>
                      <tr><td>kzDeq_SelectedType</td><td>"09&09" などの5文字の文字列</td></tr>
                    </table>
                </p>
                <p>
                    Local Storageに保存されているデータは、お使いのブラウザの設定画面から確認することができます。
                    <a href="#">戻る</a>
                </p>

            </div>

        </div>  <!-- ② end -->

    </div>  <!-- ① page main:   end -->

    <footer>

        <hr id="footer"> <!-- horizontal partition -->

        <p id="page-top"><a href="#">トップへ</a></p>
        <div class="jQ_change center" > <!-- select button whole: start -->
            <p id="footer"> <!-- select button: start -->
                <a href="etc.html">
                    <IMG src="image/button/back_off.gif" border="0" alt="Back" >
                </a>
            </p> <!-- select button: end -->
        </div> <!-- select button whole: end -->

        <div id="footer_label">
            copyright &copy; 2003 -
            <script type="text/javascript" language="JavaScript">
                date = new Date();
                document.write(date.getFullYear() + ' ');
            </script>
            <nonscript>
            </nonscript>
            Kz's Page all rights reserved
        </div>

    </footer>

</div>
</BODY>
</html>
