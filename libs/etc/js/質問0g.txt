htmlとjsについての質問です。

セレクトボックスで選択すると、js側で処理され、ページの内容が更新されます。

<p class="pb15" align="right">
    <select id="type" onchange="changeType()">
        <option disabled selected">[01] 2-Dimensional Linear Autonomous System of 1 Order</option>
        <option value="01&01">&emsp;&emsp;1. One of the eigenvalues is 0:</option>
        <option value="01&02">&emsp;&emsp;2. There are two eigenvalues with different signs:</option>
        途中略
        <option value="09&09">&emsp;&emsp;[99] User defined Equations</option>
    </select>
</p>

ページ表示中にブラウザの更新ボタンを押すと、<option value="01&01">が選択されたページに戻ってしまいます。
例えば、<option value="09&09">が選択されてそのページが表示されているとき、更新ボタンを押しても
<option value="09&09">が選択された状態を保つことはできるでしょうか？



document.addEventListener('DOMContentLoaded', (event) => {
    // ローカルストレージから選択状態を取得
    const selectedValue = localStorage.getItem('selectedType');
    if (selectedValue) {
        document.getElementById('type').value = selectedValue;
    }
});

function changeType() {
    const selectElement = document.getElementById('type');
    const selectedValue = selectElement.value;

    // 選択状態をローカルストレージに保存
    localStorage.setItem('selectedType', selectedValue);

    // ページ内容の更新処理をここに記述
    // ...
}
説明
HTML: セレクトボックスとスクリプトファイルを読み込む基本的なHTML構造です。
JavaScript:
DOMContentLoadedイベントを使って、ページが読み込まれたときにローカルストレージから選択状態を取得し、セレクトボックスに設定します。
changeType関数内で、セレクトボックスの値が変更されたときに、その値をローカルストレージに保存します。
この方法により、ユーザーがセレクトボックスで選択した値が、ブラウザの更新ボタンを押した後でも保持されます。

注意点
ローカルストレージはブラウザに依存した機能なので、同一ブラウザ内でのみ動作します。異なるブラウザやプライベートブラウジングモードでは選択状態は保持されません。
localStorageにはデータが永続的に保存されますが、必要に応じて削除する機能を追加することもできます。
これにより、ページの選択状態を維持し、ユーザー体験を向上させることができます。


ページの構成上、以下のように2つのjsを呼び出しています。

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Select Box State Persistence</title>
    <script src="deq00_v2.js"></script>
</head>

<body>
    <p class="pb15" align="right">
        <select id="type" onchange="changeType()">
            <option disabled selected>[01] 2-Dimensional Linear Autonomous System of 1 Order</option>
            <option value="01&01">&emsp;&emsp;1. One of the eigenvalues is 0:</option>
            <option value="01&02">&emsp;&emsp;2. There are two eigenvalues with different signs:</option>
            <!-- 途中略 -->
            <option value="09&09">&emsp;&emsp;[99] User defined Equations</option>
        </select>
    </p>

    <!-- deq javascript呼び出し -->
    <script src="deq01_v4.js" type="text/javascript"></script>


</body>
</html>

deq00_v2.jsに

document.addEventListener('DOMContentLoaded', (event) => {
    // ローカルストレージから選択状態を取得
    const selectedValue = localStorage.getItem('selectedType');
    if (selectedValue) {
        document.getElementById('type').value = selectedValue;
    }
});

を加え、

deq01_v4.jsのchangeType()に「選択状態をローカルストレージに保存」を追加してみましたが、
うまく処理されません。

function changeType() {
    const type = String(document.getElementById('type').value);

    // 選択状態をローカルストレージに保存
    localStorage.setItem('selectedType', type);

    const typeAry = type.split('&');

    const selectMode = document.getElementById('mode');

    document.getElementById('where').innerText = "";

    // 係数入力ボックスを表示する
    dispCoef(1);

    以下、処理
}

